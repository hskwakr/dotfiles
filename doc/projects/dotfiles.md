# dotfiles プロジェクト

このドキュメントでは、本リポジトリの dotfiles が何を指すのか、インストールスクリプトのバックアップ機構、そして `clean.sh` を利用した復元方法について説明します。

## dotfiles とは何か

一般的に "dotfiles" とは、ユーザーのホームディレクトリに置かれる設定ファイルや設定ディレクトリを指します。`~/.bashrc` や `~/.vimrc` のように名前の先頭がドット (`.`) で始まることからこのように呼ばれます。本リポジトリでは、これらの設定を Git 管理下に置き、複数の環境で同じ設定を簡単に再現できるようにしています。

## `install.sh` のバックアップ機構

`bin/install.sh` を実行すると、既存の dotfiles を安全に置き換えるために次の手順でバックアップを作成します。

1. `$HOME` に既に同名のファイルが存在する場合、まず `backups/original/` 以下に元のファイルをディレクトリ構造を保ったまま保存します。これが「オリジナルバックアップ」となり、一度だけ作成されます。
2. その後、`backups/` 直下にタイムスタンプ付きのバックアップを作成します。古いバックアップは一定数を超えると自動的に削除されます。
3. バックアップ後にシンボリックリンクを張り直し、新しい dotfiles を有効にします。

この仕組みにより、誤って既存の設定を失うことなく dotfiles を管理できます。

## `clean.sh` による復元方法

`bin/clean.sh` には複数のオプションがありますが、`-r` (またはオプションを指定しない場合に実行される復元処理) を利用することで、`install.sh` が作成したオリジナルバックアップから元の環境を復元できます。具体的には `backups/original/` から対応するファイルを `$HOME` 配下にコピーし、同名のシンボリックリンクが存在すれば削除してから復元を行います。

バックアップの整理や不要なログの削除も `clean.sh` のオプションで行えるため、インストール後のメンテナンスにも利用できます。
